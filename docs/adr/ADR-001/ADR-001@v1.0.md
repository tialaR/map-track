# üìò ADR Official Guideline

---

## ‚úÖ Status

- **ADR:** 001
- **Version:** v1.0
- **State:** Accepted
- **Scope:** DRY & Flags as the Single Source of Truth
- **Supersedes:** ‚Äî
- **Superseded by:** ‚Äî

---

## Context

In MapTrack, we observed:

- Use of loose strings for flags (`"true"`, `"false"`, `"enabled"`)
- Duplicate conditions in multiple components
- Business rules scattered across UI, hooks, and utilities

This generates:

- Silent bugs
- Low readability
- Difficulty in refactoring
- Violation of the DRY principle

---

## Decision

We officially adopted:

1. **Flags should never be strings**
2. **Flags should be boolean or union types**
3. **Rules derived from flags should reside in hooks or utilities**
4. **Components should only consume pre-made decisions**

---

## Consequences

- More predictable code
- Safer refactoring
- More reliable testing
- More declarative components

---

## üö´ WRONG format ‚Äî Flags as strings

```tsx
// ‚ùå DON'T DO THAT
if (mode === "true") {
  enableTracking();
}

if (status === "enabled") {
  renderMarker();
}

Problems:

1. Fragile strings
2. No autocomplete
3. Bugs that are difficult to detect
4. Doesn't scale

‚úÖ CORRECT form ‚Äî Typed flags
‚úî Boolean
if (isTrackingEnabled) {
  enableTracking();
}

‚úî Union type (when there is more than 1 state)
type TrackingMode = "idle" | "tracking" | "paused";

if (trackingMode === "tracking") {
  enableTracking();
}

üß† Correct separation by layer
ü™ù Hooks ‚Äî business decision
// hooks/useTrackingMode.ts
export function useTrackingMode(trackingMode: TrackingMode) {
  return {
    isIdle: trackingMode === "idle",
    isTracking: trackingMode === "tracking",
    isPaused: trackingMode === "paused",
  };
}

üß© Component ‚Äî only consumes flags
const TrackingPanel = ({ trackingMode }: { trackingMode: TrackingMode }) => {
  const { isTracking } = useTrackingMode(trackingMode);

  if (!isTracking) return null;

  return <TrackingMap />;
};


‚úî No strings
‚úî No duplicate logic
‚úî Declarative UI

üõ† Utils ‚Äî pure and reusable rules
// utils/tracking.ts
export const isTrackingActive = (trackingMode: TrackingMode) =>
  trackingMode === "tracking";

üß≠ Real-world example applied to MapTrack
‚ùå Before
if (view === "MAP_ACTIVE") {
  renderMarkers();
}

‚úÖ After
// types/ViewMode.ts
export type ViewMode = "map" | "list" | "split";

// hooks/useViewMode.ts
export const useViewMode = (viewMode: ViewMode) => ({
  showMap: viewMode === "map" || viewMode === "split",
});

const { showMap } = useViewMode(viewMode);

{
  showMap && <MapCanvas />;
}

Official Guideline

‚ùó Components DO NOT DECIDE business rules
‚ùó Flags are never free strings
‚ùó Every reusable rule lives outside the UI
```
